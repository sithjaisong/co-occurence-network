setwd("/Users/metagenomics/Desktop/Ryan co-occurrence code/revision_work/")
library(reshape)
soil_genus<-read.csv("soil_genus.csv")
soil_genus[,1]<-c(
"mgm4455737.3",
"mgm4455738.3",
"mgm4455739.3",
"mgm4455740.3",
"mgm4455741.3",
"mgm4455742.3",
"mgm4455743.3",
"mgm4455744.3",
"mgm4455745.3",
"mgm4455746.3",
"mgm4455747.3",
"mgm4455748.3",
"mgm4455749.3",
"mgm4455750.3",
"mgm4455751.3",
"mgm4455752.3",
"mgm4455753.3",
"mgm4455754.3",
"mgm4455755.3",
"mgm4455756.3",
"mgm4455757.3",
"mgm4455758.3",
"mgm4455759.3",
"mgm4455760.3",
"mgm4455761.3",
"mgm4455762.3",
"mgm4455763.3",
"mgm4455764.3",
"mgm4455765.3",
"mgm4455766.3",
"mgm4455767.3",
"mgm4455769.3",
"mgm4455770.3",
"mgm4455771.3",
"mgm4455772.3",
"mgm4455773.3",
"mgm4455774.3",
"mgm4455775.3",
"mgm4455776.3",
"mgm4455777.3",
"mgm4455778.3",
"mgm4455779.3",
"mgm4455780.3",
"mgm4455781.3",
"mgm4455782.3",
"mgm4455783.3",
"mgm4455784.3",
"mgm4455785.3",
"mgm4455786.3",
"mgm4455787.3",
"mgm4455788.3",
"mgm4455789.3",
"mgm4455790.3",
"mgm4455791.3",
"mgm4455792.3",
"mgm4455793.3",
"mgm4455794.3",
"mgm4455795.3",
"mgm4455796.3",
"mgm4455797.3",
"mgm4455798.3",
"mgm4455799.3",
"mgm4455800.3",
"mgm4455801.3",
"mgm4455802.3",
"mgm4455803.3",
"mgm4455804.3",
"mgm4455805.3",
"mgm4455806.3",
"mgm4455807.3",
"mgm4455808.3",
"mgm4455809.3",
"mgm4455810.3",
"mgm4455811.3",
"mgm4455812.3",
"mgm4455813.3",
"mgm4455814.3",
"mgm4455815.3",
"mgm4455816.3",
"mgm4455817.3",
"mgm4455818.3",
"mgm4455819.3",
"mgm4455820.3",
"mgm4455821.3",
"mgm4455822.3",
"mgm4455823.3",
"mgm4455824.3",
"mgm4455825.3"
)
names(soil_genus)[1]<-"MGRASTid"

apple_genus<-read.csv("apple_genus.csv")
apple_genus[,1]<-c(
"mgm4507292.3",
"mgm4507293.3",
"mgm4507294.3",
"mgm4507295.3",
"mgm4507296.3",
"mgm4507297.3",
"mgm4507298.3",
"mgm4507299.3",
"mgm4507300.3",
"mgm4507301.3",
"mgm4507302.3",
"mgm4507303.3",
"mgm4507304.3",
"mgm4507305.3",
"mgm4507443.3",
"mgm4507444.3",
"mgm4507445.3",
"mgm4507446.3",
"mgm4507447.3",
"mgm4507448.3",
"mgm4507306.3",
"mgm4507307.3",
"mgm4507449.3",
"mgm4507450.3",
"mgm4507308.3",
"mgm4507309.3",
"mgm4507310.3",
"mgm4507311.3",
"mgm4507312.3",
"mgm4507451.3"
)
names(apple_genus)[1]<-"MGRASTid"

body_genus_1<-read.csv("body_1_genus.csv")
body_genus_1[,1]<-c(
"mgm4456844.3",
"mgm4456777.3",
"mgm4456720.3",
"mgm4456744.3",
"mgm4456753.3",
"mgm4456853.3",
"mgm4456760.3",
"mgm4456695.3",
"mgm4456705.3",
"mgm4456739.3",
"mgm4456724.3",
"mgm4456881.3",
"mgm4456793.3",
"mgm4456696.3",
"mgm4456737.3",
"mgm4456867.3",
"mgm4456776.3",
"mgm4456854.3",
"mgm4456788.3",
"mgm4456730.3",
"mgm4456798.3",
"mgm4456803.3",
"mgm4456813.3",
"mgm4456714.3",
"mgm4456709.3",
"mgm4456810.3",
"mgm4456823.3",
"mgm4456770.3",
"mgm4456715.3",
"mgm4456771.3",
"mgm4456746.3",
"mgm4456712.3",
"mgm4456828.3",
"mgm4456839.3",
"mgm4456758.3",
"mgm4456708.3",
"mgm4456778.3",
"mgm4456780.3",
"mgm4456845.3",
"mgm4456686.3",
"mgm4456878.3",
"mgm4456785.3",
"mgm4456680.3",
"mgm4456872.3",
"mgm4456859.3",
"mgm4456743.3",
"mgm4456762.3",
"mgm4456707.3",
"mgm4456861.3",
"mgm4456773.3",
"mgm4456794.3",
"mgm4456718.3",
"mgm4456838.3",
"mgm4456819.3",
"mgm4456775.3",
"mgm4456875.3",
"mgm4456670.3",
"mgm4456873.3",
"mgm4456669.3",
"mgm4456691.3",
"mgm4456710.3",
"mgm4456827.3",
"mgm4456706.3",
"mgm4456864.3",
"mgm4456688.3",
"mgm4456874.3",
"mgm4456748.3",
"mgm4456761.3",
"mgm4456855.3",
"mgm4456812.3",
"mgm4456784.3",
"mgm4456816.3",
"mgm4456721.3",
"mgm4456682.3",
"mgm4456809.3",
"mgm4456764.3",
"mgm4456862.3",
"mgm4456824.3",
"mgm4456825.3",
"mgm4456781.3",
"mgm4456672.3",
"mgm4456840.3",
"mgm4456741.3",
"mgm4456759.3",
"mgm4456866.3",
"mgm4456687.3",
"mgm4456722.3",
"mgm4456835.3",
"mgm4456738.3",
"mgm4456786.3"
)
names(body_genus_1)[1]<-"MGRASTid"

body_genus_2<-read.csv("body_2_genus.csv")
body_genus_2[,1]<-c(
"mgm4456698.3",
"mgm4456694.3",
"mgm4456868.3",
"mgm4456683.3",
"mgm4456674.3",
"mgm4456787.3",
"mgm4456774.3",
"mgm4456791.3",
"mgm4456804.3",
"mgm4456805.3",
"mgm4456750.3",
"mgm4456848.3",
"mgm4456820.3",
"mgm4456717.3",
"mgm4456818.3",
"mgm4456685.3",
"mgm4456832.3",
"mgm4456701.3",
"mgm4456789.3",
"mgm4456697.3",
"mgm4456801.3",
"mgm4456811.3",
"mgm4456817.3",
"mgm4456797.3",
"mgm4456734.3",
"mgm4456846.3",
"mgm4456808.3",
"mgm4456727.3",
"mgm4456869.3",
"mgm4456826.3",
"mgm4456700.3",
"mgm4456735.3",
"mgm4456837.3",
"mgm4456858.3",
"mgm4456865.3",
"mgm4456831.3",
"mgm4456768.3",
"mgm4456870.3",
"mgm4456857.3",
"mgm4456836.3",
"mgm4456728.3",
"mgm4456755.3",
"mgm4456745.3",
"mgm4456830.3",
"mgm4456843.3",
"mgm4456880.3",
"mgm4456792.3",
"mgm4456863.3",
"mgm4456767.3",
"mgm4456740.3",
"mgm4456690.3",
"mgm4456713.3",
"mgm4456799.3",
"mgm4456704.3",
"mgm4456815.3",
"mgm4456847.3",
"mgm4456766.3",
"mgm4456729.3",
"mgm4456860.3",
"mgm4456829.3",
"mgm4456877.3",
"mgm4456731.3",
"mgm4456751.3",
"mgm4456763.3",
"mgm4456779.3",
"mgm4456852.3",
"mgm4456790.3",
"mgm4456742.3",
"mgm4456765.3",
"mgm4456782.3",
"mgm4456871.3",
"mgm4456849.3",
"mgm4456678.3",
"mgm4456668.3",
"mgm4456676.3",
"mgm4456732.3",
"mgm4456800.3",
"mgm4456692.3",
"mgm4456796.3",
"mgm4456807.3",
"mgm4456711.3",
"mgm4456879.3",
"mgm4456679.3",
"mgm4456747.3",
"mgm4456822.3",
"mgm4456689.3",
"mgm4456850.3",
"mgm4456736.3",
"mgm4456733.3",
"mgm4456756.3"
)
names(body_genus_2)[1]<-"MGRASTid"

body_genus_3<-read.csv("body_3_genus.csv")
body_genus_3[,1]<-c("mgm4456677.3","mgm4456681.3","mgm4456821.3","mgm4456802.3","mgm4456673.3","mgm4456723.3","mgm4456876.3","mgm4456699.3","mgm4456671.3","mgm4456772.3","mgm4456851.3","mgm4456703.3","mgm4456749.3","mgm4456834.3","mgm4456716.3","mgm4456842.3","mgm4456693.3","mgm4456795.3","mgm4456814.3","mgm4456725.3","mgm4456754.3","mgm4456833.3","mgm4456719.3","mgm4456702.3","mgm4456675.3","mgm4456806.3","mgm4456769.3","mgm4456752.3","mgm4456726.3","mgm4456856.3","mgm4456841.3","mgm4456684.3","mgm4456757.3","mgm4456783.3"
)
names(body_genus_3)[1]<-"MGRASTid"

#melting before joining with other datasets before casting
soil_genus_melt<-melt(soil_genus, id="MGRASTid")
apple_genus_melt<-melt(apple_genus, id="MGRASTid")
body_genus_1_melt<-melt(body_genus_1, id="MGRASTid")
body_genus_2_melt<-melt(body_genus_2, id="MGRASTid")
body_genus_3_melt<-melt(body_genus_3, id="MGRASTid")


#cast into data.frame
total_genus<-rbind(soil_genus_melt,apple_genus_melt,body_genus_1_melt,body_genus_2_melt,body_genus_3_melt)
#332 is the number of MGRASTid's and should be the number of rows after casting
total_genus_cast<-data.frame(cast(total_genus, MGRASTid~variable, value="value",fun.aggregate=sum, add.missing=TRUE))

write.csv(total_genus_cast, "total_genus_mgrastid.csv", row.names=FALSE)

